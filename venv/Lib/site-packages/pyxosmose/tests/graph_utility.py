from pyxosmose.models.et import Et
from pyxosmose.models.layer import Layer
from pyxosmose.models.unit import Unit
from pyxosmose.models.unit_param import UnitParam
from pyxosmose.models.stream import Stream
from pyxosmose.models.basicstream import OtherStreamData
from pyxosmose.models.heatstream import HeatStreamData
from pyxosmose.serializers.graph_et import EtGraphSerializer


def get_unit_process(layer_ng):
    unit_process = Unit()
    unit_process.unitname = "process1"
    unit_process.type = "Process"

    unit_param1 = UnitParam()
    p1 = "P1"
    unit_param1.cost1 = "0"
    unit_param1.cost2 = "0"
    unit_param1.cinv1 = "0"
    unit_param1.cinv2 = "0"
    unit_param1.imp1 = "0"
    unit_param1.imp2 = "0"
    unit_param1.fmin = "1"
    unit_param1.fmax = "1"

    unit_param2 = UnitParam()
    p2 = "P2"
    unit_param2.cost1 = "0"
    unit_param2.cost2 = "0"
    unit_param2.cinv1 = "0"
    unit_param2.cinv2 = "0"
    unit_param2.imp1 = "0"
    unit_param2.imp2 = "0"
    unit_param2.fmin = "1"
    unit_param2.fmax = "1"
    unit_process.add_unit_params(p1, unit_param1)
    unit_process.add_unit_params(p2, unit_param2)

    ng_stream = Stream()
    ng_stream.name = layer_ng.name
    ng_stream.type = layer_ng.short_name
    ng_stream.is_heat = False
    ng_stream.unit = layer_ng.unit
    ng_stream.direction = "in"
    ng_stream.add_datas("P1", OtherStreamData('2.5'))
    ng_stream.add_datas("P2", OtherStreamData('2.5'))
    unit_process.add_stream(ng_stream)

    c1_heat_stream = Stream()
    c1_heat_stream.name = "C1"
    c1_heat_stream.type = "heat"
    c1_heat_stream.is_heat = True
    c1_heat_stream.add_datas("P1", HeatStreamData(tin='20', tout='135', hin='0', hout='230', dtmin='5', alpha='1', temperature_unit='C°', hentalpy_unit='kW'))
    c1_heat_stream.add_datas("P2", HeatStreamData(tin='20', tout='135', hin='0', hout='230', dtmin='5', alpha='1', temperature_unit='C°', hentalpy_unit='kW'))

    c2_heat_stream = Stream()
    c2_heat_stream.name = "C2"
    c2_heat_stream.type = "heat"
    c2_heat_stream.is_heat = True
    c2_heat_stream.add_datas("P1", HeatStreamData(tin='170', tout='60', hin='330', hout='0', dtmin='5', alpha='1', temperature_unit='C°', hentalpy_unit='kW'))
    c2_heat_stream.add_datas("P2", HeatStreamData(tin='170', tout='60', hin='330', hout='0', dtmin='5', alpha='1', temperature_unit='C°', hentalpy_unit='kW'))

    c3_heat_stream = Stream()
    c3_heat_stream.name = "C3"
    c3_heat_stream.type = "heat"
    c3_heat_stream.is_heat = True
    c3_heat_stream.add_datas("P1",
                             HeatStreamData(tin='80', tout='140', hin='0', hout='240', dtmin='5', alpha='0.5', temperature_unit='C°', hentalpy_unit='kW'))
    c3_heat_stream.add_datas("P2",
                             HeatStreamData(tin='80', tout='140', hin='0', hout='240', dtmin='5', alpha='0.5', temperature_unit='C°', hentalpy_unit='kW'))

    c4_heat_stream = Stream()
    c4_heat_stream.name = "C4"
    c4_heat_stream.type = "heat"
    c4_heat_stream.is_heat = True
    c4_heat_stream.add_datas("P1",
                             HeatStreamData(tin='150', tout='30', hin='180', hout='0', dtmin='5', alpha='0.2', temperature_unit='C°', hentalpy_unit='kW'))
    c4_heat_stream.add_datas("P2",
                             HeatStreamData(tin='150', tout='30', hin='180', hout='0', dtmin='5', alpha='0.2', temperature_unit='C°', hentalpy_unit='kW'))

    unit_process.add_stream(c1_heat_stream)
    unit_process.add_stream(c2_heat_stream)
    unit_process.add_stream(c3_heat_stream)
    unit_process.add_stream(c4_heat_stream)
    return unit_process


def get_unit_hotutility(layer_elec):
    unit_HotUtility = Unit()

    unit_HotUtility.unitname = "HotUtility"
    unit_HotUtility.type = "Utility"

    unit_HotUtility_param1 = UnitParam()
    p1 = "P1"
    unit_HotUtility_param1.cost1 = "0"
    unit_HotUtility_param1.cost2 = "0"
    unit_HotUtility_param1.cinv1 = "0"
    unit_HotUtility_param1.cinv2 = "0"
    unit_HotUtility_param1.imp1 = "0"
    unit_HotUtility_param1.imp2 = "0"
    unit_HotUtility_param1.fmin = "0"
    unit_HotUtility_param1.fmax = "10000"

    unit_HotUtility_param2 = UnitParam()
    p2 = "P2"
    unit_HotUtility_param2.cost1 = "0"
    unit_HotUtility_param2.cost2 = "0"
    unit_HotUtility_param2.cinv1 = "0"
    unit_HotUtility_param2.cinv2 = "0"
    unit_HotUtility_param2.imp1 = "0"
    unit_HotUtility_param2.imp2 = "0"
    unit_HotUtility_param2.fmin = "0"
    unit_HotUtility_param2.fmax = "10000"

    unit_HotUtility.add_unit_params(p1, unit_HotUtility_param1)
    unit_HotUtility.add_unit_params(p2, unit_HotUtility_param2)

    elec_stream = Stream()
    elec_stream.name = layer_elec.name
    elec_stream.type = layer_elec.short_name
    elec_stream.is_heat = False
    elec_stream.unit = layer_elec.unit
    elec_stream.direction = "in"
    elec_stream.add_datas("P1", OtherStreamData('1.25'))
    elec_stream.add_datas("P2", OtherStreamData('1.25'))
    unit_HotUtility.add_stream(elec_stream)

    s1_heat_stream = Stream()
    s1_heat_stream.name = "S1"
    s1_heat_stream.type = "heat"
    s1_heat_stream.is_heat = True
    s1_heat_stream.add_datas("P1", HeatStreamData(tin='350', tout='350', hin='1', hout='0', dtmin='5', alpha='1', temperature_unit='C°', hentalpy_unit='kW'))
    s1_heat_stream.add_datas("P2", HeatStreamData(tin='350', tout='350', hin='1', hout='0', dtmin='5', alpha='1', temperature_unit='C°', hentalpy_unit='kW'))
    unit_HotUtility.add_stream(s1_heat_stream)

    return unit_HotUtility


def get_unit_coolingwater(layer_elec):
    unit_CoolingWater = Unit()

    unit_CoolingWater.unitname = "CoolingWater"
    unit_CoolingWater.type = "Utility"

    unit_CoolingWater_param1 = UnitParam()
    p1 = "P1"
    unit_CoolingWater_param1.cost1 = "0"
    unit_CoolingWater_param1.cost2 = "0.0144"
    unit_CoolingWater_param1.cinv1 = "0"
    unit_CoolingWater_param1.cinv2 = "0"
    unit_CoolingWater_param1.imp1 = "0"
    unit_CoolingWater_param1.imp2 = "0"
    unit_CoolingWater_param1.fmin = "0"
    unit_CoolingWater_param1.fmax = "10000"

    unit_CoolingWater_param2 = UnitParam()
    p2 = "P2"
    unit_CoolingWater_param2.cost1 = "0"
    unit_CoolingWater_param2.cost2 = "0.0144"
    unit_CoolingWater_param2.cinv1 = "0"
    unit_CoolingWater_param2.cinv2 = "0"
    unit_CoolingWater_param2.imp1 = "0"
    unit_CoolingWater_param2.imp2 = "0"
    unit_CoolingWater_param2.fmin = "0"
    unit_CoolingWater_param2.fmax = "10000"

    unit_CoolingWater.add_unit_params(p1, unit_CoolingWater_param1)
    unit_CoolingWater.add_unit_params(p2, unit_CoolingWater_param2)

    elec_stream = Stream()
    elec_stream.name = layer_elec.name
    elec_stream.type = layer_elec.short_name
    elec_stream.is_heat = False
    elec_stream.unit = layer_elec.unit
    elec_stream.direction = "in"
    elec_stream.add_datas("P1", OtherStreamData('0.42'))
    elec_stream.add_datas("P2", OtherStreamData('0.42'))
    unit_CoolingWater.add_stream(elec_stream)

    cw1_heat_stream = Stream()
    cw1_heat_stream.name = "CW1"
    cw1_heat_stream.type = "heat"
    cw1_heat_stream.is_heat = True
    cw1_heat_stream.add_datas("P1", HeatStreamData(tin='15', tout='20', hin='0', hout='21', dtmin='2', alpha='1', temperature_unit='C°', hentalpy_unit='kW'))
    cw1_heat_stream.add_datas("P2", HeatStreamData(tin='15', tout='20', hin='0', hout='21', dtmin='2', alpha='1', temperature_unit='C°', hentalpy_unit='kW'))

    unit_CoolingWater.add_stream(cw1_heat_stream)

    return unit_CoolingWater


def get_unit_ngasbuy(layer_ng):
    unit_NGas_buy = Unit()
    unit_NGas_buy.unitname = "NGas_buy"
    unit_NGas_buy.type = "Utility"

    unit_NGas_buy_param1 = UnitParam()
    p1 = "P1"
    unit_NGas_buy_param1.cost1 = "0"
    unit_NGas_buy_param1.cost2 = "0.09"
    unit_NGas_buy_param1.cinv1 = "0"
    unit_NGas_buy_param1.cinv2 = "0"
    unit_NGas_buy_param1.imp1 = "0"
    unit_NGas_buy_param1.imp2 = "0.045"
    unit_NGas_buy_param1.fmin = "0"
    unit_NGas_buy_param1.fmax = "100000"

    unit_NGas_buy_param2 = UnitParam()
    p2 = "P2"
    unit_NGas_buy_param2.cost1 = "0"
    unit_NGas_buy_param2.cost2 = "0.09"
    unit_NGas_buy_param2.cinv1 = "0"
    unit_NGas_buy_param2.cinv2 = "0"
    unit_NGas_buy_param2.imp1 = "0"
    unit_NGas_buy_param2.imp2 = "0.045"
    unit_NGas_buy_param2.fmin = "0"
    unit_NGas_buy_param2.fmax = "100000"
    unit_NGas_buy.add_unit_params(p1, unit_NGas_buy_param1)
    unit_NGas_buy.add_unit_params(p2, unit_NGas_buy_param2)

    ng_stream = Stream()
    ng_stream.name = layer_ng.name
    ng_stream.type = layer_ng.short_name
    ng_stream.is_heat = False
    ng_stream.unit = layer_ng.unit
    ng_stream.direction = "out"
    ng_stream.add_datas("P1", OtherStreamData('1'))
    ng_stream.add_datas("P2", OtherStreamData('1'))
    unit_NGas_buy.add_stream(ng_stream)

    return unit_NGas_buy


def get_unit_electricitybuy(layer_elec):
    unit_Electricity_buy = Unit()

    unit_Electricity_buy.unitname = "Electricity_buy"
    unit_Electricity_buy.type = "Utility"

    unit_Electricity_buy_param1 = UnitParam()
    p1 = "P1"
    unit_Electricity_buy_param1.cost1 = "0"
    unit_Electricity_buy_param1.cost2 = "0.05"
    unit_Electricity_buy_param1.cinv1 = "0"
    unit_Electricity_buy_param1.cinv2 = "0"
    unit_Electricity_buy_param1.imp1 = "0"
    unit_Electricity_buy_param1.imp2 = "0.086"
    unit_Electricity_buy_param1.fmin = "0"
    unit_Electricity_buy_param1.fmax = "100000"

    unit_Electricity_buy_param2 = UnitParam()
    p2 = "P2"
    unit_Electricity_buy_param2.cost1 = "0"
    unit_Electricity_buy_param2.cost2 = "0.03"
    unit_Electricity_buy_param2.cinv1 = "0"
    unit_Electricity_buy_param2.cinv2 = "0"
    unit_Electricity_buy_param2.imp1 = "0"
    unit_Electricity_buy_param2.imp2 = "0.046"
    unit_Electricity_buy_param2.fmin = "0"
    unit_Electricity_buy_param2.fmax = "100000"

    unit_Electricity_buy.add_unit_params(p1, unit_Electricity_buy_param1)
    unit_Electricity_buy.add_unit_params(p2, unit_Electricity_buy_param2)

    elec_stream = Stream()
    elec_stream.name = layer_elec.name
    elec_stream.type = layer_elec.short_name
    elec_stream.is_heat = False
    elec_stream.unit = layer_elec.unit
    elec_stream.direction = "out"
    elec_stream.add_datas("P1", OtherStreamData('1'))
    elec_stream.add_datas("P2", OtherStreamData('1'))
    unit_Electricity_buy.add_stream(elec_stream)

    return unit_Electricity_buy


def get_graph_txt():
    return """digraph et {
    rankdir = LR
    newrank = true

    subgraph inlayers {
        rank = same
        ng [label='Natural Gaz', shape=cds, style=filled, color=black, fillcolor=green]
        elec [label='Electricity', shape=cds, style=filled, color=black, fillcolor=yellow]
    }

    subgraph units {
        rank = same
        process1 [label=<
            <table border='0' collspacing='0'>
                <tr><td></td><td><b>process1</b></td><td></td></tr>
                <tr><td></td></tr>
                <tr><td>Heat:</td></tr>
                <tr>
                    <td bgcolor='#9fc5e8:#ffe1e1'><font color='blue'>20 C°</font></td>
                    <td bgcolor='#ffe1e1'><font color='black'>230 kW</font></td>
                    <td bgcolor='#ffe1e1:#ff9898'><font color='red'>135 C°</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#ffe1e1:#9fc5e8'><font color='red'>170 C°</font></td>
                    <td bgcolor='#9fc5e8'><font color='black'>330 kW</font></td>
                    <td bgcolor='#9fc5e8:#5eb2ff'><font color='blue'>60 C°</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#9fc5e8:#ffe1e1'><font color='blue'>80 C°</font></td>
                    <td bgcolor='#ffe1e1'><font color='black'>240 kW</font></td>
                    <td bgcolor='#ffe1e1:#ff9898'><font color='red'>140 C°</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#ffe1e1:#9fc5e8'><font color='red'>150 C°</font></td>
                    <td bgcolor='#9fc5e8'><font color='black'>180 kW</font></td>
                    <td bgcolor='#9fc5e8:#5eb2ff'><font color='blue'>30 C°</font></td>
                 </tr>
                <tr><td></td></tr>
                <tr><td>Costs:</td></tr>
                 <tr>
                    <td>Op 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Op 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
        </table>>, shape=box]
        HotUtility [label=<
            <table border='0' collspacing='0'>
                <tr><td></td><td><b>HotUtility</b></td><td></td></tr>
                <tr><td></td></tr>
                <tr><td>Heat:</td></tr>
                <tr>
                    <td bgcolor='#d0c2d0'><font color='black'>350 C°</font></td>
                    <td bgcolor='#d0c2d0'><font color='black'>1 kW</font></td>
                    <td bgcolor='#d0c2d0'><font color='black'>350 C°</font></td>
                 </tr>
                <tr><td></td></tr>
                <tr><td>Costs:</td></tr>
                 <tr>
                    <td>Op 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Op 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
        </table>>, shape=box]
        CoolingWater [label=<
            <table border='0' collspacing='0'>
                <tr><td></td><td><b>CoolingWater</b></td><td></td></tr>
                <tr><td></td></tr>
                <tr><td>Heat:</td></tr>
                <tr>
                    <td bgcolor='#9fc5e8:#ffe1e1'><font color='blue'>15 C°</font></td>
                    <td bgcolor='#ffe1e1'><font color='black'>21 kW</font></td>
                    <td bgcolor='#ffe1e1:#ff9898'><font color='red'>20 C°</font></td>
                 </tr>
                <tr><td></td></tr>
                <tr><td>Costs:</td></tr>
                 <tr>
                    <td>Op 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Op 2:</td>
                    <td></td>
                    <td>0.0144</td>
                 </tr>
                 <tr>
                    <td>Inv 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
        </table>>, shape=box]
        NGas_buy [label=<
            <table border='0' collspacing='0'>
                <tr><td></td><td><b>NGas_buy</b></td><td></td></tr>
                <tr><td></td></tr>
                <tr><td></td></tr>
                <tr><td>Costs:</td></tr>
                 <tr>
                    <td>Op 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Op 2:</td>
                    <td></td>
                    <td>0.09</td>
                 </tr>
                 <tr>
                    <td>Inv 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
        </table>>, shape=box]
        Electricity_buy [label=<
            <table border='0' collspacing='0'>
                <tr><td></td><td><b>Electricity_buy</b></td><td></td></tr>
                <tr><td></td></tr>
                <tr><td></td></tr>
                <tr><td>Costs:</td></tr>
                 <tr>
                    <td>Op 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Op 2:</td>
                    <td></td>
                    <td>0.05</td>
                 </tr>
                 <tr>
                    <td>Inv 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
        </table>>, shape=box]
    }

    subgraph outlayers {
        rank = same
        outng [label='Natural Gaz', shape=cds, style=filled, color=black, fillcolor=green]
        outelec [label='Electricity', shape=cds, style=filled, color=black, fillcolor=yellow]
    }

    ng -> process1 [label='2.5 [kW]', color=black]
    elec -> HotUtility [label='1.25 [kW]', color=black]
    elec -> CoolingWater [label='0.42 [kW]', color=black]
    NGas_buy -> outng [label='1 [kW]', color=black]
    Electricity_buy -> outelec [label='1 [kW]', color=black]
}"""


def get_et1_graph_txt():
    return """digraph et {
    rankdir = LR
    newrank = true

    subgraph inlayers {
        rank = same
        ng [label='Gas buy', shape=cds, style=filled, color=black, fillcolor=green]
    }

    subgraph units {
        rank = same
        past [label=<
            <table border='0' collspacing='0'>
                <tr><td></td><td><b>past</b></td><td></td></tr>
                <tr><td></td></tr>
                <tr><td>Heat:</td></tr>
                <tr>
                    <td bgcolor='#9fc5e8:#ffe1e1'><font color='blue'>4 C</font></td>
                    <td bgcolor='#ffe1e1'><font color='black'>1693.44 kW</font></td>
                    <td bgcolor='#ffe1e1:#ff9898'><font color='red'>60 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#9fc5e8:#ffe1e1'><font color='blue'>60 C</font></td>
                    <td bgcolor='#ffe1e1'><font color='black'>428.64 kW</font></td>
                    <td bgcolor='#ffe1e1:#ff9898'><font color='red'>75 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#ffe1e1:#9fc5e8'><font color='red'>75 C</font></td>
                    <td bgcolor='#9fc5e8'><font color='black'>2090.95 kW</font></td>
                    <td bgcolor='#9fc5e8:#5eb2ff'><font color='blue'>4 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#9fc5e8:#ffe1e1'><font color='blue'>4 C</font></td>
                    <td bgcolor='#ffe1e1'><font color='black'>0.055664 kW</font></td>
                    <td bgcolor='#ffe1e1:#ff9898'><font color='red'>75 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#9fc5e8:#ffe1e1'><font color='blue'>60 C</font></td>
                    <td bgcolor='#ffe1e1'><font color='black'>24.48 kW</font></td>
                    <td bgcolor='#ffe1e1:#ff9898'><font color='red'>75 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#ffe1e1:#9fc5e8'><font color='red'>75 C</font></td>
                    <td bgcolor='#9fc5e8'><font color='black'>116.369 kW</font></td>
                    <td bgcolor='#9fc5e8:#5eb2ff'><font color='blue'>4 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#ffe1e1:#9fc5e8'><font color='red'>6 C</font></td>
                    <td bgcolor='#9fc5e8'><font color='black'>60.48 kW</font></td>
                    <td bgcolor='#9fc5e8:#5eb2ff'><font color='blue'>4 C</font></td>
                 </tr>
                <tr><td></td></tr>
                <tr><td>Costs:</td></tr>
                 <tr>
                    <td>Op 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Op 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
        </table>>, shape=box]
        evap [label=<
            <table border='0' collspacing='0'>
                <tr><td></td><td><b>evap</b></td><td></td></tr>
                <tr><td></td></tr>
                <tr><td>Heat:</td></tr>
                <tr>
                    <td bgcolor='#9fc5e8:#ffe1e1'><font color='blue'>4 C</font></td>
                    <td bgcolor='#ffe1e1'><font color='black'>1349 kW</font></td>
                    <td bgcolor='#ffe1e1:#ff9898'><font color='red'>75 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#ffe1e1:#9fc5e8'><font color='red'>75 C</font></td>
                    <td bgcolor='#9fc5e8'><font color='black'>95 kW</font></td>
                    <td bgcolor='#9fc5e8:#5eb2ff'><font color='blue'>70 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#d0c2d0'><font color='black'>70 C</font></td>
                    <td bgcolor='#d0c2d0'><font color='black'>2333.8 kW</font></td>
                    <td bgcolor='#d0c2d0'><font color='black'>70 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#d0c2d0'><font color='black'>70 C</font></td>
                    <td bgcolor='#d0c2d0'><font color='black'>2333.8 kW</font></td>
                    <td bgcolor='#d0c2d0'><font color='black'>70 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#ffe1e1:#9fc5e8'><font color='red'>70 C</font></td>
                    <td bgcolor='#9fc5e8'><font color='black'>23.16951 kW</font></td>
                    <td bgcolor='#9fc5e8:#5eb2ff'><font color='blue'>25 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#ffe1e1:#9fc5e8'><font color='red'>70 C</font></td>
                    <td bgcolor='#9fc5e8'><font color='black'>83.72 kW</font></td>
                    <td bgcolor='#9fc5e8:#5eb2ff'><font color='blue'>65 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#d0c2d0'><font color='black'>65 C</font></td>
                    <td bgcolor='#d0c2d0'><font color='black'>3003.136 kW</font></td>
                    <td bgcolor='#d0c2d0'><font color='black'>65 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#d0c2d0'><font color='black'>65 C</font></td>
                    <td bgcolor='#d0c2d0'><font color='black'>3003.136 kW</font></td>
                    <td bgcolor='#d0c2d0'><font color='black'>65 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#ffe1e1:#9fc5e8'><font color='red'>65 C</font></td>
                    <td bgcolor='#9fc5e8'><font color='black'>12.39056 kW</font></td>
                    <td bgcolor='#9fc5e8:#5eb2ff'><font color='blue'>25 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#ffe1e1:#9fc5e8'><font color='red'>65 C</font></td>
                    <td bgcolor='#9fc5e8'><font color='black'>56.9296 kW</font></td>
                    <td bgcolor='#9fc5e8:#5eb2ff'><font color='blue'>60 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#d0c2d0'><font color='black'>60 C</font></td>
                    <td bgcolor='#d0c2d0'><font color='black'>2830.2 kW</font></td>
                    <td bgcolor='#d0c2d0'><font color='black'>60 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#d0c2d0'><font color='black'>60 C</font></td>
                    <td bgcolor='#d0c2d0'><font color='black'>2830.2 kW</font></td>
                    <td bgcolor='#d0c2d0'><font color='black'>60 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#ffe1e1:#9fc5e8'><font color='red'>60 C</font></td>
                    <td bgcolor='#9fc5e8'><font color='black'>175.812 kW</font></td>
                    <td bgcolor='#9fc5e8:#5eb2ff'><font color='blue'>25 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#ffe1e1:#9fc5e8'><font color='red'>60 C</font></td>
                    <td bgcolor='#9fc5e8'><font color='black'>356.3123 kW</font></td>
                    <td bgcolor='#9fc5e8:#5eb2ff'><font color='blue'>4 C</font></td>
                 </tr>
                <tr><td></td></tr>
                <tr><td>Costs:</td></tr>
                 <tr>
                    <td>Op 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Op 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
        </table>>, shape=box]
        masc [label=<
            <table border='0' collspacing='0'>
                <tr><td></td><td><b>masc</b></td><td></td></tr>
                <tr><td></td></tr>
                <tr><td>Heat:</td></tr>
                <tr>
                    <td bgcolor='#9fc5e8:#ffe1e1'><font color='blue'>4 C</font></td>
                    <td bgcolor='#ffe1e1'><font color='black'>127.9069 kW</font></td>
                    <td bgcolor='#ffe1e1:#ff9898'><font color='red'>82 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#9fc5e8:#ffe1e1'><font color='blue'>82 C</font></td>
                    <td bgcolor='#ffe1e1'><font color='black'>10.81636 kW</font></td>
                    <td bgcolor='#ffe1e1:#ff9898'><font color='red'>90 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#ffe1e1:#9fc5e8'><font color='red'>90 C</font></td>
                    <td bgcolor='#9fc5e8'><font color='black'>110.8677 kW</font></td>
                    <td bgcolor='#9fc5e8:#5eb2ff'><font color='blue'>8 C</font></td>
                 </tr>
                <tr><td></td></tr>
                <tr><td>Costs:</td></tr>
                 <tr>
                    <td>Op 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Op 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
        </table>>, shape=box]
        mozz [label=<
            <table border='0' collspacing='0'>
                <tr><td></td><td><b>mozz</b></td><td></td></tr>
                <tr><td></td></tr>
                <tr><td>Heat:</td></tr>
                <tr>
                    <td bgcolor='#9fc5e8:#ffe1e1'><font color='blue'>4 C</font></td>
                    <td bgcolor='#ffe1e1'><font color='black'>111.0816 kW</font></td>
                    <td bgcolor='#ffe1e1:#ff9898'><font color='red'>32 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#9fc5e8:#ffe1e1'><font color='blue'>32 C</font></td>
                    <td bgcolor='#ffe1e1'><font color='black'>95.2128 kW</font></td>
                    <td bgcolor='#ffe1e1:#ff9898'><font color='red'>56 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#9fc5e8:#ffe1e1'><font color='blue'>56 C</font></td>
                    <td bgcolor='#ffe1e1'><font color='black'>26.17333 kW</font></td>
                    <td bgcolor='#ffe1e1:#ff9898'><font color='red'>75 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#ffe1e1:#9fc5e8'><font color='red'>75 C</font></td>
                    <td bgcolor='#9fc5e8'><font color='black'>61.989441 kW</font></td>
                    <td bgcolor='#9fc5e8:#5eb2ff'><font color='blue'>30 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#ffe1e1:#9fc5e8'><font color='red'>30 C</font></td>
                    <td bgcolor='#9fc5e8'><font color='black'>34.0415335 kW</font></td>
                    <td bgcolor='#9fc5e8:#5eb2ff'><font color='blue'>13 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#ffe1e1:#9fc5e8'><font color='red'>85 C</font></td>
                    <td bgcolor='#9fc5e8'><font color='black'>26.166 kW</font></td>
                    <td bgcolor='#9fc5e8:#5eb2ff'><font color='blue'>80 C</font></td>
                 </tr>
                <tr><td></td></tr>
                <tr><td>Costs:</td></tr>
                 <tr>
                    <td>Op 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Op 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
        </table>>, shape=box]
        cip [label=<
            <table border='0' collspacing='0'>
                <tr><td></td><td><b>cip</b></td><td></td></tr>
                <tr><td></td></tr>
                <tr><td>Heat:</td></tr>
                <tr>
                    <td bgcolor='#9fc5e8:#ffe1e1'><font color='blue'>25 C</font></td>
                    <td bgcolor='#ffe1e1'><font color='black'>175.812 kW</font></td>
                    <td bgcolor='#ffe1e1:#ff9898'><font color='red'>60 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#9fc5e8:#ffe1e1'><font color='blue'>60 C</font></td>
                    <td bgcolor='#ffe1e1'><font color='black'>334.88 kW</font></td>
                    <td bgcolor='#ffe1e1:#ff9898'><font color='red'>80 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#ffe1e1:#9fc5e8'><font color='red'>75 C</font></td>
                    <td bgcolor='#9fc5e8'><font color='black'>226.044 kW</font></td>
                    <td bgcolor='#9fc5e8:#5eb2ff'><font color='blue'>30 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#ffe1e1:#9fc5e8'><font color='red'>80 C</font></td>
                    <td bgcolor='#9fc5e8'><font color='black'>83.72 kW</font></td>
                    <td bgcolor='#9fc5e8:#5eb2ff'><font color='blue'>75 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#ffe1e1:#9fc5e8'><font color='red'>75 C</font></td>
                    <td bgcolor='#9fc5e8'><font color='black'>175.812 kW</font></td>
                    <td bgcolor='#9fc5e8:#5eb2ff'><font color='blue'>60 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#9fc5e8:#ffe1e1'><font color='blue'>25 C</font></td>
                    <td bgcolor='#ffe1e1'><font color='black'>83.7 kW</font></td>
                    <td bgcolor='#ffe1e1:#ff9898'><font color='red'>40 C</font></td>
                 </tr>
                <tr><td></td></tr>
                <tr><td>Costs:</td></tr>
                 <tr>
                    <td>Op 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Op 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
        </table>>, shape=box]
        rive [label=<
            <table border='0' collspacing='0'>
                <tr><td></td><td><b>rive</b></td><td></td></tr>
                <tr><td></td></tr>
                <tr><td>Heat:</td></tr>
                <tr>
                    <td bgcolor='#9fc5e8:#ffe1e1'><font color='blue'>25 C</font></td>
                    <td bgcolor='#ffe1e1'><font color='black'>95.5947611 kW</font></td>
                    <td bgcolor='#ffe1e1:#ff9898'><font color='red'>99.63 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#9fc5e8:#ffe1e1'><font color='blue'>25 C</font></td>
                    <td bgcolor='#ffe1e1'><font color='black'>130.128768 kW</font></td>
                    <td bgcolor='#ffe1e1:#ff9898'><font color='red'>99.63 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#ffe1e1:#9fc5e8'><font color='red'>99.63 C</font></td>
                    <td bgcolor='#9fc5e8'><font color='black'>86.5374617 kW</font></td>
                    <td bgcolor='#9fc5e8:#5eb2ff'><font color='blue'>50 C</font></td>
                 </tr>
                <tr><td></td></tr>
                <tr><td>Costs:</td></tr>
                 <tr>
                    <td>Op 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Op 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
        </table>>, shape=box]
        hu [label=<
            <table border='0' collspacing='0'>
                <tr><td></td><td><b>hu</b></td><td></td></tr>
                <tr><td></td></tr>
                <tr><td>Heat:</td></tr>
                <tr>
                    <td bgcolor='#d0c2d0'><font color='black'>1000 C</font></td>
                    <td bgcolor='#d0c2d0'><font color='black'>1000 kW</font></td>
                    <td bgcolor='#d0c2d0'><font color='black'>1000 C</font></td>
                 </tr>
                <tr><td></td></tr>
                <tr><td>Costs:</td></tr>
                 <tr>
                    <td>Op 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Op 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
        </table>>, shape=box]
        cu [label=<
            <table border='0' collspacing='0'>
                <tr><td></td><td><b>cu</b></td><td></td></tr>
                <tr><td></td></tr>
                <tr><td>Heat:</td></tr>
                <tr>
                    <td bgcolor='#d0c2d0'><font color='black'>0 C</font></td>
                    <td bgcolor='#d0c2d0'><font color='black'>1000 kW</font></td>
                    <td bgcolor='#d0c2d0'><font color='black'>0 C</font></td>
                 </tr>
                <tr><td></td></tr>
                <tr><td>Costs:</td></tr>
                 <tr>
                    <td>Op 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Op 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
        </table>>, shape=box]
    }

    subgraph outlayers {
        rank = same
    }

    ng -> hu [label='1111.1111 [[dol/kWh]]', color=black]
}"""


def get_coolingtower_graph_txt():
    return """digraph et {
    rankdir = LR
    newrank = true

    subgraph inlayers {
        rank = same
        elec [label='Electricity', shape=cds, style=filled, color=black, fillcolor=yellow]
    }

    subgraph units {
        rank = same
        CoolTower [label=<
            <table border='0' collspacing='0'>
                <tr><td></td><td><b>CoolTower</b></td><td></td></tr>
                <tr><td></td></tr>
                <tr><td>Heat:</td></tr>
                <tr>
                    <td bgcolor='#9fc5e8:#ffe1e1'><font color='blue'>15 C</font></td>
                    <td bgcolor='#ffe1e1'><font color='black'>1000 kW</font></td>
                    <td bgcolor='#ffe1e1:#ff9898'><font color='red'>25 C</font></td>
                 </tr>
                <tr><td></td></tr>
                <tr><td>Costs:</td></tr>
                 <tr>
                    <td>Op 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Op 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
        </table>>, shape=box]
    }

    subgraph outlayers {
        rank = same
    }

    elec -> CoolTower [label='21.0 [kWh]', color=black]
}"""


def get_furnace_graph_txt():
    return """digraph et {
    rankdir = LR
    newrank = true

    subgraph inlayers {
        rank = same
    }

    subgraph units {
        rank = same
        Furnace [label=<
            <table border='0' collspacing='0'>
                <tr><td></td><td><b>Furnace</b></td><td></td></tr>
                <tr><td></td></tr>
                <tr><td>Heat:</td></tr>
                <tr>
                    <td bgcolor='#d0c2d0'><font color='black'>1050 C</font></td>
                    <td bgcolor='#d0c2d0'><font color='black'>480.6897966 kW</font></td>
                    <td bgcolor='#d0c2d0'><font color='black'>1050 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#ffe1e1:#9fc5e8'><font color='red'>1050 C</font></td>
                    <td bgcolor='#9fc5e8'><font color='black'>481.6355828 kW</font></td>
                    <td bgcolor='#9fc5e8:#5eb2ff'><font color='blue'>100 C</font></td>
                 </tr>
                <tr>
                    <td bgcolor='#9fc5e8:#ffe1e1'><font color='blue'>25 C</font></td>
                    <td bgcolor='#ffe1e1'><font color='black'>0.3492412 kW</font></td>
                    <td bgcolor='#ffe1e1:#ff9898'><font color='red'>26 C</font></td>
                 </tr>
                <tr><td></td></tr>
                <tr><td>Costs:</td></tr>
                 <tr>
                    <td>Op 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Op 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
        </table>>, shape=box]
    }

    subgraph outlayers {
        rank = same
    }

}"""


def get_market_graph_txt():
    return """digraph et {
    rankdir = LR
    newrank = true

    subgraph inlayers {
        rank = same
        milk [label='Milk buy', shape=cds, style=filled, color=black, fillcolor=white]
        dioxmarket [label='CO2 buy', shape=cds, style=filled, color=black, fillcolor=grey]
    }

    subgraph units {
        rank = same
        ElecSell [label=<
            <table border='0' collspacing='0'>
                <tr><td></td><td><b>ElecSell</b></td><td></td></tr>
                <tr><td></td></tr>
                <tr><td></td></tr>
                <tr><td>Costs:</td></tr>
                 <tr>
                    <td>Op 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Op 2:</td>
                    <td></td>
                    <td>70.0</td>
                 </tr>
                 <tr>
                    <td>Inv 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
        </table>>, shape=box]
        NatgasSell [label=<
            <table border='0' collspacing='0'>
                <tr><td></td><td><b>NatgasSell</b></td><td></td></tr>
                <tr><td></td></tr>
                <tr><td></td></tr>
                <tr><td>Costs:</td></tr>
                 <tr>
                    <td>Op 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Op 2:</td>
                    <td></td>
                    <td>32.0</td>
                 </tr>
                 <tr>
                    <td>Inv 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
        </table>>, shape=box]
        WaterSell [label=<
            <table border='0' collspacing='0'>
                <tr><td></td><td><b>WaterSell</b></td><td></td></tr>
                <tr><td></td></tr>
                <tr><td></td></tr>
                <tr><td>Costs:</td></tr>
                 <tr>
                    <td>Op 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Op 2:</td>
                    <td></td>
                    <td>3690.0</td>
                 </tr>
                 <tr>
                    <td>Inv 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
        </table>>, shape=box]
        MilkBuy [label=<
            <table border='0' collspacing='0'>
                <tr><td></td><td><b>MilkBuy</b></td><td></td></tr>
                <tr><td></td></tr>
                <tr><td></td></tr>
                <tr><td>Costs:</td></tr>
                 <tr>
                    <td>Op 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Op 2:</td>
                    <td></td>
                    <td>-500000</td>
                 </tr>
                 <tr>
                    <td>Inv 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
        </table>>, shape=box]
        CO2Buy [label=<
            <table border='0' collspacing='0'>
                <tr><td></td><td><b>CO2Buy</b></td><td></td></tr>
                <tr><td></td></tr>
                <tr><td></td></tr>
                <tr><td>Costs:</td></tr>
                 <tr>
                    <td>Op 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Op 2:</td>
                    <td></td>
                    <td>-8.4</td>
                 </tr>
                 <tr>
                    <td>Inv 1:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
                 <tr>
                    <td>Inv 2:</td>
                    <td></td>
                    <td>0</td>
                 </tr>
        </table>>, shape=box]
    }

    subgraph outlayers {
        rank = same
        outelec [label='Electricity Sell', shape=cds, style=filled, color=black, fillcolor=yellow]
        outng [label='NatGas Sell', shape=cds, style=filled, color=black, fillcolor=green]
        outwater [label='Water Sell', shape=cds, style=filled, color=black, fillcolor=blue]
    }

    ElecSell -> outelec [label='1000 [kWh]', color=black]
    NatgasSell -> outng [label='1000 [kW]', color=black]
    WaterSell -> outwater [label='1000 [m^3/h]', color=black]
    milk -> MilkBuy [label='1000 [m^3/h]', color=black]
    dioxmarket -> CO2Buy [label='1000 [kg/h]', color=black]
}"""